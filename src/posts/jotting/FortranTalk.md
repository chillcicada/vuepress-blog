---
title: Fortran 杂谈
date: 2024-01-14
tag:
  - Fortran
  - Small Talk
  - Course
category:
  - Jotting
  - Course
---

# Fortran 杂谈

> 前半部分为选修 Fortran 程设课程的杂谈，后半部分为对 Fortran 语言的杂谈。

<!-- more -->

## 课程杂谈

Fortran 课程是我遇到的第一门既有每周作业又有大作业还有有考试的通识课程（如果算上观星报告的话，这学期的天文学导论也算），老师讲得不好不坏吧，上课很无聊，而且感觉比较水，要不是人少可能我就翘了x。以及老师我不是很喜欢，有些观点很固执，在此不举例描述。

先讲考试，因为通识课的原因，早上九点的考试，大概考试前三十分钟两位监考的学生志愿者才来到教室，考前十五分钟教室才熙熙攘攘来了很多人（这门课程也就大概不到二十人的样子）。

考试内容不算难，差不多算简单的概念辨析，和一些简单的人肉编译内容，除了有一个控制 ifort 编译器数组越界检查的参数没怎么用过想不起来外其他都还好，两小时的考试用了不到二十分钟就写完了，稍微挣扎了一下还是交卷了（有一个人比我还早交卷x）。

关于那个越界检查控制的参数后面又看了一下是 `-check bound`，是后来讲的错误与调试部分的内容，这部分复习的时候一点没看，所以分丢的不怨qaq。不过有一说一，因为平时几乎只用 gfortran，加之高版本的 gfortran 加了很多静态检查（疑似包括数组越界检查），所以平时也几乎接触不到这个参数的使用场景（笑）。

其次是课程作业和大作业的设置，感觉这部分内容看老师，前面的 Fortran 编程部分的作业拿高分比较难，得有得到刘老师认可的亮点，唯一一次拿的高分是排序算法手写栈实现快排，按部就班的做只能拿到 90 分左右的成绩，属于是有点为难我这大二学生qaq，后面讲并行计算的作业就好很多，基本照着要求写一遍就给满分。一些奇怪的要求是要写调试报告，虽然这是一个很好的习惯，不过对于作业而言更多像一种浪费时间的任务，有点恶心。大作业部分严格来讲是有两个大作业的，不过算大作业的分只算并行计算的大作业，这点比较恶心，因为 Fortran 语言的综合运用部分完全更一个正常的程设1课程的大作业没什么区别，过程式编程加一点点类（差不多对应 Fortran 语言的 module）的应用一套下来，虽然相较而言设置的要求比较低，实现起来比较轻松。并行计算的大作业则感觉完全称不上大作业，虽然也是一次并行计算的综合练习，但说实话，我个人觉得并行计算要上手是很简单的，而恰好给的作业实际上就是这样一个入门进阶的问题。

最后，因为最终的成绩还没公布，所以较为中肯的点评一下，因为这门课只有两学分，而内容量比较大，所以对于大一大二的来说非常不推荐去报，而且修这门课最好有一些 C/C++ 的知识（不是 OOP 的知识），Fortran 和 C 可以联合编译，同时老师讲课时也倾向于把两个语言结合在一起讲，因而，有一些相关的基础能大大提高对语言语法和应用的理解。

---

这门课给我最大的收获大抵是入坑了 vim，这下站在鄙视链顶端了（笑）。

## Fortran 语言杂谈

> 其实我最开始没想修这么一门课，最初是从思想家公社上了解到计算化学领域还使用着 Fortran 语言，本着好奇的心理在选课门户上搜了一下，加之一种特殊的语言全收集想法，于是果断退掉了听不懂的管理学基础选了这门课。
>
> Emm，现在看这不是一个好的决定，加之我也没给它 PF。
>
> 一下内容并不是基于课程的思考和回复，纯粹基于语言，我个人是认为 Fortran 已经是半身入土的语言了。

首先回答一个关键的问题，Fortran 语言在现在还有什么用？我个人觉得 Fortran 自提出并发展至今，其核心的适用领域始终是科学计算，要谁现在还在用 Fortran 做 OOP 的话我肯定会挂出 TA（冷知识：现代的 Fortran 支持 OOP），换言之，Fortran 语言是高度 DSL （领域特定语言）的，由此带来的编程范式的问题值得另起一段便不再赘述，Fortran 语言的核心在于数组操作，由于 Fortran 语言是矩阵列展开的，加之其自带矩阵分割切片等操作，使得 Fortran 语言在矩阵运算的效率上是不可比拟的（客观讲，在这方面 C 语言也无法比拟），基于 Fortran 的 Matlab 是个很好的例子。

> 客观上讲，Fortran 是一个怎么样的语言。

我不喜欢讲完全过时的东西（比如我认为反现代的 FortranFixed 语法），所以关于语言本身的讨论重点以 Modern Fortran 为主。

- Fortran 语法真的很简单，如果你对相关英语词汇量有积累的话，几乎不用教程就能看明白 Fortran 的语法，在某种程度上，Fortran 的语法更像是伪代码（，拿现有编程语言来对比化，Fortran 这种就好比 Pascal，没什么字符，大部分运算靠关键字实现，以下面的代码为例：

```Fortran
! 这是一段模拟蒙特卡洛方法计算 pi 的代码
program main
  implicit none
  integer :: throw = 28000000, hits = 0, i
  real    :: dist, x2, y2, x, y, ratio, pi

  do i = 1, throw
    call random_number(x)
    call random_number(y)

    x2 = x * x
    y2 = y * y
    dist = sqrt(x2 + y2)

    if (dist .le. 1.0) then
      hits = hits + 1
    endif
  end do

  ratio = real(hits) / real(throw)
  pi = 4.0 * ratio
  write (*, "('the value of pi is calculated to be ', f14.8)") pi
end program main
```

> 未来打算用 Fortran 编程吗？

大概率不会，在**科学计算方面**虽然 Fortran（数组操作），C/C++（内存操作），Matlab（数值分析），Mathematica（数学分析），Julia（JIT） 乃至 Python（生态丰富） 都有一定特点和优势，但是要我选的话我大概率未来就用 python 和 julia 两个语言，其他的语言能读懂就好，一个比较热的知识是上面提到的几个语言是几乎支持向前兼容和调用的。~~毕竟过时的东西就应该被淘汰~~

拿 Python 讲吧，Python 什么都好，最大的问题是效率与 GIL（全局解释器锁，特指 CPython 和 PyPy），尽管可以通过 CUDA 等方式来优化，但说实话，

> Fortran 的历史包袱

我个人认为这个问题全归到语言上并不是一个令人认可的做法。尽管 Fortran 堆成的屎山是客观存在的，但首先，这个问题最大的原因在于用这样一门科学计算的语言的人并不是专业的编程人员，加之作为早期的语言，Fortran 并没有强调编程范式这样一种标准，以至于写出来的东西格式千奇百怪（其实现在的 python 也是一样，即使有 PEP 的存在），一个生动的例子是，写代码的人不会去向注释和命名的问题，甚至大部分早些时候的代码更流行单字母命名，这种人肉混淆器的做法在现在看来简直是反人类的。
